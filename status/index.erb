<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>DistribuStream Status</title>
  <link href="stylesheets/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <h1><img src="images/logo.png" alt="DistribuStream Status" /></h1>
  <div id="server_info">
    Host: <%= vhost %><br />
    <%= client_count %>
  </div>
  <center>
    <h2>Files</h2>
    <table border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th>URL</th>
        <th>Size</th>
        <th>DLs</th>
        <th>ULs</th>
      </tr>
      
      <% each_file do |file| %>
        <tr class="row<%= cycle('', '  row_alternate') %>">
          <td><%= file_url(file) %></td>
          <td><%= file_size(file) %></td>
          <td style="text-align: right"><%= file_downloaders(file) %></td>
          <td style="text-align: right"><%= file_uploaders(file) %></td>
        </tr>
      <% end %>
    </table>
    
    <br/>
    <h2>Transfers</h2>
    <table border="0" cellpadding="0" cellspacing="0">
      <tr>
				<th>Client</th>
				<th>Bandwidth</th>
				<th>Transfers</th>
				<th>Files</th>
			</tr>
			
      <% each_peer do |peer| %>
        <tr class="row<%= cycle(' row_alternate', '') %>">
					<td>
						<%= peer_name(peer) %><br />
						<%= peer_address(peer) %>
	        </td>
					<td>
						Upstream: <%= upstream_bandwidth(peer) %><br />
						Downstream: <%= downstream_bandwidth(peer) %>
					</td>
	        <td>
	        <% each_transfer(peer) do |transfer| %>
	          <%= transfer_info(peer, transfer) %><br />
	        <% end %>
	        </td>
	        <td>
	        <% each_peer_file(peer) do |file| %>
	          <%= file_path(file) %> 
	          (<%= chunks_completed(file) %>/<%= chunks_active(file) %>, 
	          <%= percent_complete(file) %>%)<br />
	        <% end %>
	        </td>
				</tr>
      <% end %>
    </table>
  </center>
  <hr />
  <div id="footer"> 
    <%= vhost %> - 
    <a href="http://distribustream.org/">DistribuStream</a> <%= PDTP::VERSION %> 
    &copy;2006-08 <a href="http://www.clickcaster.com/">ClickCaster, Inc.</a><br />
    <%= Time.now %>
  </div>
</body>
</html>
